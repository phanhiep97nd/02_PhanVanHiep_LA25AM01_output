/**
 * Copyright(C) 2020  Luvina Software
 * TblUserLogicImpl.java, Jul 14, 2020 Phan Văn Hiệp
 */
package manageuser.logics.impl;

import java.security.NoSuchAlgorithmException;
import java.sql.SQLException;

import manageuser.dao.impl.TblUserDaoImpl;
import manageuser.entities.TblUserEntity;
import manageuser.logics.TblUserLogic;
import manageuser.utils.Common;

/**
 * Thực thi các hàm của TblUserLogic
 * @author Phan Van Hiep
 */
public class TblUserLogicImpl implements TblUserLogic{

	@Override
	public Boolean checkExistLogin(String loginName, String pass) throws ClassNotFoundException, SQLException, NoSuchAlgorithmException {
		TblUserDaoImpl userDao = new TblUserDaoImpl();
		TblUserEntity user = userDao.getTblUserByLoginName(loginName);
		System.out.println(user.getPass());
		System.out.println(user.getSalt());
		String passEnscrypt = Common.enscryptPassword(pass, user.getSalt());
		boolean check = Common.compareString(passEnscrypt, user.getPass());
		return check;
	}
	public static void main(String[] args) throws NoSuchAlgorithmException, ClassNotFoundException, SQLException {
		System.out.println(Common.enscryptPassword("123456", "2020-07-14T05:48:22.198"));
		TblUserLogicImpl t = new TblUserLogicImpl();
		System.out.println(t.checkExistLogin("admin1","123456"));
	}
}
